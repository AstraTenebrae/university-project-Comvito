{% extends "base.html" %}

{% block header %}
    <form action="{{url_for('offer_creation')[1:]}}">
        <button class="btn-primary">Создать предложение</button>
    </form>
{% endblock %}


{% block main_content %}
        <!-- Поиск -->
        <section class="mb-2">
            <input type="text" class="form-control mb-1" placeholder="Что ищете, товарищ?">
            <div class="d-flex gap-1" style="overflow-x: auto;">
                <button class="btn-secondary active">Всё</button>
                <button class="btn-secondary">Одежда</button>
                <button class="btn-secondary">Книги</button>
                <button class="btn-secondary">Электроника</button>
            </div>
        </section>

        <!-- Карточки товаров -->
        <section>
            {% for offer in offers %}
            <div class="card mb-1">
                <div class="card-body">
                    <div class="card-title">{{ offer.offer_name }}</div>
                    <div class="card-text mb-1">{{ offer.offer_description }}</div>
                    <div class="d-flex justify-content-between text-muted">
                        <span>{{ offer.user.username if offer.user else 'Неизвестный пользователь' }}</span>
                        <span class="text-primary">~ 0.5 км</span> <!-- Пока оставляем заглушку для расстояния -->
                    </div>
                    {% if offer.conditions %}
                    <div class="mt-1 mb-1">
                        <small><strong>Условия обмена:</strong> {{ offer.conditions }}</small>
                    </div>
                    {% endif %}
                    <button class="btn-primary mt-1" style="width: 100%;">Предложить обмен</button>
                </div>
            </div>
            {% else %}
            <div class="card mb-1">
                <div class="card-body">
                    <div class="card-title">Предложения отсутствуют</div>
                    <div class="card-text mb-1">Будьте первым, кто предложит обмен!</div>
                    <div class="d-flex justify-content-between text-muted">
                        <span>Администрация</span>
                        <span class="text-primary">~ 0 км</span>
                    </div>
                    <a href="{{url_for('offer_creation')}}">
                        <button class="btn-primary mt-1" style="width: 100%;">Создать первое предложение</button>
                    </a>
                </div>
            </div>
            {% endfor %}
        </section>

    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
                {% for message in messages %}
                <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
{% endblock %}

{% block script %}
    <script>
        // Простой скрипт для переключения активных кнопок фильтров
        document.querySelectorAll('.btn-secondary').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.btn-secondary').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
    </script>
{% endblock %}